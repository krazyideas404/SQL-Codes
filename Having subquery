SELECT H.HACKER_ID, H.NAME, COUNT(H.HACKER_ID) AS MAX_CNT
FROM HACKERS H
INNER JOIN CHALLENGES C
ON C.HACKER_ID = H.HACKER_ID
GROUP BY H.HACKER_ID, H.NAME
HAVING MAX_CNT = (SELECT MAX(H1.CNT)
                  FROM (SELECT COUNT(HACKER_ID) CNT
                  FROM CHALLENGES
                  GROUP BY HACKER_ID
                  ORDER BY HACKER_ID) H1)
OR MAX_CNT IN (SELECT H2.CNT
              FROM (SELECT COUNT(*) as CNT 
                    from CHALLENGES
                    group by HACKER_ID) H2
              GROUP BY H2.cnt
              HAVING COUNT(H2.CNT) = 1)
ORDER BY COUNT(H.HACKER_ID) DESC, H.HACKER_ID
