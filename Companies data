SELECT COM.COMPANY_CODE, FOUNDER, LEAD_MNGR_CNT, SNR_MNGR_CNT, MNGR_CNT, EMP_CNT
FROM COMPANY COM
JOIN (SELECT COMPANY_CODE, COUNT(DISTINCT LEAD_MANAGER_CODE) LEAD_MNGR_CNT FROM LEAD_MANAGER GROUP BY COMPANY_CODE) LEAD_MNGR
ON COM.COMPANY_CODE = LEAD_MNGR.COMPANY_CODE
JOIN (SELECT COMPANY_CODE, COUNT(DISTINCT SENIOR_MANAGER_CODE) SNR_MNGR_CNT FROM SENIOR_MANAGER GROUP BY COMPANY_CODE) SNR_MNGR
ON COM.COMPANY_CODE = SNR_MNGR.COMPANY_CODE
JOIN (SELECT COMPANY_CODE, COUNT(DISTINCT MANAGER_CODE) MNGR_CNT FROM MANAGER GROUP BY COMPANY_CODE) MNGR
ON COM.COMPANY_CODE = MNGR.COMPANY_CODE
JOIN (SELECT COMPANY_CODE, COUNT(DISTINCT EMPLOYEE_CODE) EMP_CNT FROM EMPLOYEE GROUP BY COMPANY_CODE) EMP
ON COM.COMPANY_CODE = EMP.COMPANY_CODE
GROUP BY COM.COMPANY_CODE, FOUNDER
ORDER BY COM.COMPANY_CODE
