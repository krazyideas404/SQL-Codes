SELECT ID, AGE, COINS_NEEDED, POWER
FROM WANDS W
JOIN WANDS_PROPERTY P
ON W.CODE = P.CODE
WHERE IS_EVIL = 0
AND COINS_NEEDED = (SELECT MIN(COINS_NEEDED) 
                    FROM WANDS W1 JOIN WANDS_PROPERTY P1 
                    ON (W1.CODE = P1.CODE) WHERE W1.POWER = W.POWER AND P1.AGE=P.AGE)
ORDER BY POWER DESC, AGE DESC
